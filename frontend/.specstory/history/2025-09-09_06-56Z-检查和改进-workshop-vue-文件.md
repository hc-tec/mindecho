<!-- Generated by SpecStory -->

# 检查和改进 workshop.vue 文件 (2025-09-09 06:56Z)

_**User (2025-09-09 04:39Z)**_

我目前携带的信息是上一次的上下文，阅读完之后再接着完成我下面需要的功能

你再仔细检查检查当前的workshop.vue文件
1. 目前这个界面太太太太太丑了！！！！！界面设计参考后面我发的提示词
2. 后端数据需要做出哪些改变，目前点击其中一个发现跳转到的页面是http://localhost:3000/workshops/1，有什么问题你跟我说说
3. 还有哪些需要改进的你都跟我提



---

_**Assistant**_



---

I'll scan the `workshops` listing and detail files plus the store to identify the UI structure, navigation behavior, and data model issues before suggesting and implementing fixes. Then I'll propose a UI revamp and any backend changes needed.

---

Read file: undefined

---

Read file: undefined

---

Read file: undefined

---

Read file: undefined

---

Read file: undefined

---

<think><details><summary>Thought Process</summary>**Identifying routing issues**

I'm noticing that clicking the listing card's button triggers a router push, but it doesn’t preload the necessary workshop data. The `[id].vue` file lacks a method to fetch data, which means it needs a call to `fetchWorkshops()` on page mount or during `onServerPrefetch`. 

I think it's important to have an endpoint for fetching a single workshop by ID, and the absence of `fetchWorkshopById` in the store should be addressed. Also, having a more SEO-friendly route would be beneficial. Lastly, the route parameter validation seems off, and I need to ensure the manage endpoint is correct.
**Examining backend access**

I’m realizing we need to inspect the backend, but the frontend is essentially just our view. It seems backend files have been modified according to the git status, but accessing files outside the workspace could be an issue. The tool can read files using absolute paths, so I think we could check something like `D:\mindecho2\backend\app\main.py`. 

I wonder if I should proceed with that since the git status shows changes. Another point to address is discussing what modifications are required for the backend.
**Accessing backend endpoints**

I think it's important to inspect the backend to understand the existing endpoints and how changes should be made. I’ll call `read_file` for `D:\mindecho2\backend\app\main.py`, and perhaps look into other API modules as well. Since the repository structure isn’t clear to me, accessing files using an absolute path seems like the best option for now. I’m keen to see what I can find in those files to inform our modifications!</details></think>

---

I'll inspect the backend routes to verify available workshop endpoints and identify needed changes, then I'll review the UI file to propose a redesign and fix navigation/data loading.

---

Read file: undefined

---

<think><details><summary>Thought Process</summary>**Reviewing workshop requests**

The user wants to continue discussing the `workshops.vue` file. They have three main requests. First, they’ve expressed that the UI is "太太太太太丑" and they want to redesign it based on prompts they'll send later. I think I should suggest some immediate improvements using UI components like shadcn-vue. Second, they noted an issue with backend data; when clicking a workshop link, it leads to `http://localhost:3000/workshops/1`. I need to investigate the store and backend for possible problems with how the workshop ID is being handled.
**Investigating workshop ID issues**

I see there's a problem when clicking on `workshops/1`, as it fails to find the right dynamic component. The `getWorkshopById` function is using `'1'` to try and find a workshop, but I'm not sure how `type` fits in. The `Workshop` interface has a property for `type`, but the backend seeds it with `executor_type=et` set as `'llm_chat'`, which isn't very helpful. There seem to be different `workshop_id` strings like "summary-01," and I need to figure out how to map the expected `type` properly. It looks like it could be an ID or `workshop_id` issue.
**Identifying backend changes**

The store is expecting the endpoint `/workshops/manage` to return a list of `Workshop` objects, but there seems to be a mismatch. I think we need to change the backend so that it returns an `id` string that matches `workshop_id` and maybe also set `type` to match. Alternatively, we could update the frontend to use `workshop.workshop_id` if it exists, but the front-end types currently don’t include that field. Since routing uses `workshop.id`, we might actually need to route by `workshop.workshop_id` instead. I’ll check the backend endpoint shape in `workshops.py` to confirm.</details></think>

---

I'll check the backend workshops endpoint to confirm the response shape and ids, then review related models/schemas to pinpoint mismatches with the frontend expectations.

---

<details>
            <summary>Listed directory undefined • **0** results</summary>
        
No results found
</details>

---

Read file: undefined

---

<think><details><summary>Thought Process</summary>**Evaluating workshop API routes**

I’m looking at the route for updating and deleting workshops, which uses `/api/v1/workshops/manage/{workshop_id}`. It seems there’s a mismatch since the store’s update and delete methods directly access `/workshops/${id}` instead of the manage path. Additionally, the create action uses `/workshops`, while the create method on the backend is `/workshops/manage`. Also, there's a mismatch in the executeWorkshop method, where it uses 'favorite_item_id' instead of the expected 'collection_id'. It all seems a bit tangled!
**Identifying frontend-backend discrepancies**

I'm noticing issues in how the frontend treats the `id` as a string, while it uses strict equality '=== id', where `w.id` might actually be a number. The `Workshop` interface in `types/api.ts` defines `id` as a string, but the backend returns it as numeric. We should use 'workshop_id' in the route, like 'information-alchemy', but the current implementation leads to paths like '/workshops/1'. Plus, the dynamic loader expects 'type', which isn't present in the backend. So, it looks like the mapping needs fixing to align with 'workshop_id'.
**Analyzing workshop navigation issues**

For question 2, users click a card that leads them to `/workshops/1`, but there’s a problem because it uses the database's internal id instead of a user-friendly slug. The store can’t find the 'type' property, causing the dynamic component to load incorrectly. Plus, the store doesn’t ensure that the data is loaded before navigating. If a user refreshes or uses a direct link, the store might show empty workshops, leaving a loading message indefinitely. We need to fetch data if missing, use `workshop_id` slugs, and check `WorkshopConfigForm.vue` for consistency with the store and backend.</details></think>

---

Read file: undefined

---

<think><details><summary>Thought Process</summary>**Checking workshop components**

I need to look at the components 'InformationAlchemy.vue,' 'PointCounterpoint.vue,' and 'GenericWorkshop.vue' since they probably need config fields like default prompts. I'll open these workshop components to see what props they expect. I noticed they were in the recently viewed list, so that might make it easier to find them. Let's ensure I read them carefully to verify what’s required!</details></think>

---

I'll open the workshop components to confirm the expected fields and behavior so I can align the store/types and navigation.

---

Read file: undefined

---

<think><details><summary>Thought Process</summary>**Reviewing API endpoints**

I’m noticing that the backend uses `workshop_id`, `default_prompt`, `default_model`, `executor_type`, and `executor_config`, but probably not `system_prompt` or `user_prompt_template`. The store's `createWorkshop` and `updateWorkshop` functions are calling the wrong endpoints; they should be targeting `/workshops/manage` instead of `/workshops`. 

There's also a mismatch with DELETE operations and how workshops are listed. The workshop ID used for navigation should be a string, not a numeric ID, which could create confusion when trying to go to the details page.
**Analyzing Vue component mismatches**

I’m seeing that the `[id].vue` page utilizes `workshopsStore.getWorkshopById(workshopId.value)`, which fetches the workshop based on its numeric ID, but this conflicts with our `Workshop` interface. The `getWorkshopById` function checks `w.id === id`, meaning the route parameter should match a numeric string ID.

However, the dynamic component is fetching `workshop.value.type`, while the backend offers `executor_type`, which is another mismatch. Plus, `InformationAlchemy.vue` expects both `workshopInfo` and `workshop`, but `[id].vue` only passes `workshop`. This could lead to a runtime warning or error for the missing `workshopInfo`.
**Identifying props and ID mismatches**

I’ve realized that the `script setup defineProps` requires `workshopInfo`, but `[id].vue` doesn’t pass it, which is definitely a bug. In `InformationAlchemy.vue`, `currentId` uses `props.workshop?.id` or `props.workshopInfo?.id`, but the store expects a string `workshopId` to call `api.post(`/workshops/${workshopId}/execute`). 

The issue is that the backend requires a `workshop_id` string, but we’re dealing with a numeric ID. This creates confusion when routing to `/workshops/1`, as the detail page expects to map to the `workshop_id`, not the numeric ID. Additionally, the dynamic component needs to map to `executor_type`, which isn’t aligned with the expected values.
**Proposing alignment changes**

For the dynamic component loader, it seems we should map mostly using `workshop_id` or `executor_type`. The UI is designed to load components that correspond to the workshop's `workshop_id` string alias or its `type`. There's also a `FallbackWorkshop.vue`, but it’s not part of the current mapping, so I need to suggest some changes.

First, I would align the front-end `Workshop` type with the backend `WorkshopSchema` by including fields like `id` (numeric), `workshop_id` (string), `name`, and others while removing outdated fields like `type` and `system_prompt`. 

Next, I’d update the `workshopsStore`: the `fetchWorkshops` should correctly call `/workshops/manage`, but it needs to reflect the new interface. The `executeWorkshop` call must use `workshop.workshop_id` instead of the previous workshop ID format, and ensure to replace the `favorite_item_id` with the `collection_id` expected by `WorkshopExecutionRequest`.
**Examining seeding and parameter mismatches**

I’m noticing that in the `startup_event`, the `workshop_service.start_workshop_task` function is called with `collection_id=db_item.id`, but `db_item` represents a `FavoriteItem` row id. This creates a mismatch because while the endpoint expects a "collection_id," we're really passing a favorite item ID. 

Our front-end `InformationAlchemy.vue` uses `selectedCollection`, which is typed as `FavoriteItem`, and passes `selectedCollection.value.id` for `executeWorkshop`. This results in the store building the body with `favorite_item_id`, but the backend endpoint requires a `collection_id` in the JSON. So, we definitely need to align the parameter names and ensure we send `collection_id` instead of `favorite_item_id`. I'll check `app/services/workshop_service.py` for confirmation.</details></think>

---

<details>
            <summary>Listed directory undefined • **0** results</summary>
        
No results found
</details>

---

Read file: undefined

---

<think><details><summary>Thought Process</summary>**Considering front-end fixes**

I'm looking at a proposed fix for the front end, which involves adding a mapping in the store after fetching workshops. I see that `user_prompt_template` isn’t present in the backend, so I could either fill it with an empty string or use `default_prompt` for both prompts. However, it might be better to update the backend to include `user_prompt_template`. I’ll need to check the unified schema in the backend for the necessary fields.</details></think>

---

<details>
            <summary>Listed directory undefined • **0** results</summary>
        
No results found
</details>

---

Read file: undefined

---

<think><details><summary>Thought Process</summary>**Planning code edits**

I see that there are multiple steps for the code edits: we should create a TODO list to update store types, fix route parameters, and adjust the dynamic loader. The user has noted that the UI in `workshops.vue` looks ugly and wants a redesign based on prompts. They also mention backend changes and route issues, but they haven't explicitly asked for changes yet. Since they previously asked to continue implementing functionality, I should prepare some minimal fixes now and work on improving the UI layout using existing Tailwind components.
**Defining tasks for code updates**

I need to follow tool usage guidelines and use `todo_write` for these multi-step tasks. The tasks include fixing the frontend-backend model mismatch for Workshops, addressing navigation and dynamic component loading, and updating the WorkshopConfigForm to align with the backend's endpoints. 

I also want to improve the `workshops.vue` UI by redesigning grid cards, adding a header, and implementing search/sort features. Plus, I should ensure robust loading, empty, and error states. I'll definitely run the linter after these edits and examine the `workshops.vue` code for further improvements.
**Proposing UI improvements**

I have some ideas for UI enhancements! First, I'd suggest a hero header with a gradient background, a big title, a tagline, and possibly a search input with filters. 

The workshop cards should display the name, description, and tags for `executor_type` or `workshop_id`. When hovered, a "Preview" overlay would appear. I think we could use a floating 'New Workshop' button too.

We could leverage components from the UI library like `Badge` for tags and `DropdownMenu`. I want to implement search functionality with a computed `filteredWorkshops`, add sorting, skeleton loaders, and an empty state with a CTA to create workshops. Lastly, I’ll update the route to pass `workshop_id` as a slug instead of a numeric ID.
**Updating workshop ID handling**

I need to update the store function, `getWorkshopById`, to locate workshops by `workshop_id` rather than a numeric ID. This requires mapping property names in the store for consistency. Currently, the store has `workshops` typed as `Workshop[]` from `types/api.ts`, which we need to modify to match the backend's new unified `Workshop` schema.

I noticed that existing components like `InformationAlchemy.vue` and others expect the previous structure. They reference `workshopInfo: Workshop` and may use either a string or numeric ID. To accommodate this, `executeWorkshop` should use `workshopId: string` as a slug instead of a numeric ID for proper handling.
**Adjusting workshop type handling**

It looks like there's some confusion about the `id` type defined as a string, which matches with slug use. The initial fetch returns `id: int; workshop_id: str`, so I need to adjust the store to reinterpret these. 

One option is to unify the front type to `WorkshopRecord`, changing the usage of `workshop_id` to be recognized as the slug ID. However, that could cause issues elsewhere. Instead, I’ll map the backend fields to the front `Workshop` type on fetch from `api.get('/workshops/manage')`, ensuring the mapping continues to work for all expected code components.

This includes updating `updateWorkshop` and `createWorkshop` endpoints as well. Additionally, I note that `InformationAlchemy.vue` needs to accept `workshopInfo` as required, as it currently misses props since it's passing `workshop`, not `workshopInfo`. I should also check `GenericWorkshop.vue` and `PointCounterpoint.vue` to ensure they are set up correctly.</details></think>

---

I'll open the other workshop components to check their expected props and align the route/component usage.

---

Read file: undefined

---

Read file: undefined

---

<think><details><summary>Thought Process</summary>**Identifying route mismatches**

I’m noticing a problem with our dynamic route. The `workshopId` parameter is numeric, but the backend uses a string slug like "information-alchemy." The `workshops/[id].vue` file calls a method that looks for workshop IDs, while the backend returns a list of workshops with a different structure. The expected fields on the front-end don’t match what's provided by the backend, particularly regarding key parameters like `collection_id` and `executor_type`. I need to resolve these mismatches!
**Diagnosing component mismatches**

It looks like our setup is set to fail. The `API_BASE_URL` directs to `127.0.0.1:8001`, and the WebSocket path matches — but there are several issues. For instance, clicking on `/workshops/1` uses a numeric 'id', while component mapping needs a `type` like 'InformationAlchemy'. The backend doesn't provide this `type`, so components fall back to a generic option. 

Also, the prop mismatch in `InformationAlchemy.vue` is a concern; it expects `workshopInfo`, but the dynamic loader is providing `workshop`, which creates a significant mismatch.
**Analyzing prop and schema mismatches**

So, the `workshop` prop is defined as optional in the `InformationAlchemy.vue` component, which means it's acceptable to use either `workshopInfo` or `workshop` to retrieve the ID. That part seems fine. However, I’m noticing a significant mismatch between the `Workshop` type on the frontend and the backend schema. The frontend has different properties compared to the backend’s structure. 

Also, the endpoints for creating, updating, and deleting workshops are mismatched, as the frontend is using the wrong paths which could lead to errors with the backend.
**Identifying loading issues**

I'm realizing there's a complete mismatch happening. When clicking on `/workshops/1`, the dynamic view tries to get the workshop using `getWorkshopById(id)`, but it runs into trouble if the ID passed is a string while the workshop ID is numeric. The frontend expects a string, but the backend returns a number. If `workshop.id` is 1 (number) and id is '1' (string), they'll never match, leading to `workshop` becoming undefined in `[id].vue`. This results in indefinite loading on the page, which is likely the issue at hand!
**Planning necessary changes**

We need to make some critical changes. First, the navigation ID should use `workshop_id` as the route parameter instead of the numeric database ID. In `workshops.vue`, I’ll adjust the `goToWorkshop` function to push the correct slug. 

The `getWorkshopById` method needs to search by `workshop_id`, and we should align our data structures with the backend. This includes modifying components to match the provided backend shape. Addressing the UI design in `workshops.vue`, which the user described as "ugly," is essential, so I'll focus on that as well. 

Overall, we need to implement these changes methodically while keeping user feedback in mind!
**Addressing routing and mapping changes**

I see that we need to fix several issues related to routing and data mapping. We should change `goToWorkshop(workshop.id)` to use `workshop.workshop_id`, so clicking a workshop will lead to the correct route like `/workshops/information-alchemy`. This will also involve updating the `getWorkshopById` function to compare the correct ID format.

The `executeWorkshop` endpoint must be adjusted from `favorite_item_id` to `collection_id` to match backend expectations. Also, we need to modify payload keys to align with backend naming conventions.

Additionally, we’ll enhance the UI structure in `workshops.vue`, aiming for a more appealing layout, which involves the use of various components. Overall, it's a multi-pronged approach!
**Reforming workshop management processes**

I’m focusing on refining workshop-related processes. For `createWorkshop`, we’ll set the endpoint to `/workshops/manage`, requiring fields like `workshop_id`. If `workshop_id` isn't provided, I can generate one from the name or type using a slug format. Meanwhile, `deleteWorkshop` will get its path as `/workshops/manage/{id}`.

For the `executeWorkshop`, I need to modify the body to expect `collection_id` and `prompt`. In `[id].vue`, I’ll ensure to fetch initial data if the `workshop` isn't found. We want to enhance the UI in `workshops.vue` with a new aesthetic and improved navigation. It’s all about making this user-friendly!
**Enhancing workshop UI and functionality**

I’m working on updates for `workshops.vue`. First, I’ll keep the `goToWorkshop` function with the slug ID. The UI needs improvement, so I want to add a hero header that includes a title like "Workshops" or "AI 工作坊," and a search feature.

For the card grid, I'll import icons from `lucide-vue-next` and ensure they have a sleek hover effect. In `[id].vue`, I’ll adjust component props and ensure proper data fetching, refining how we handle the workshop data to maintain a smooth user experience. Lastly, I’ll draft a TODO list to keep track of tasks related to backend mapping and interface improvements.</details></think>

---

I'll create a task list to track aligning the store with backend, fix routing/detail loading, and improve the workshops page UI, then implement them now.

---

## Todo List

- [-] Align workshops store with backend schema and endpoints
- [ ] Fix workshop detail routing and ensure data loads on direct navigation
- [ ] Revamp workshops listing UI for better aesthetics (initial pass)

---

<think><details><summary>Thought Process</summary>**Analyzing workshop component issues**

The detail page `[id].vue` relies on the workshop being available in the store, but the `fetchWorkshops` function is triggered only on the `workshops.vue` page. If I go directly to `/workshops/1` or refresh, `workshopsStore.workshops` might not be loaded. The page would show "加载中..." if the workshop isn't found, and it doesn’t call `fetchWorkshops`. Furthermore, there's a prop mismatch — `[id].vue` passes `workshop`, but components expect `workshopInfo`. We need to standardize prop names across the components.
**Identifying API inconsistencies**

There are some inconsistencies I need to address. The `executeWorkshop` function in the store should post to `/workshops/${workshopId}/execute` with a body parameter of `favorite_item_id`. However, the backend expects this parameter to be named `collection_id`. While the endpoint path is correct, the mismatch in parameters is problematic. Additionally, `subscribeToTask` is using the correct websocket URL; the backend path is accurate. Still, the `fetchTask` function needs to connect properly with the backend tasks endpoint. I'll need to check that.</details></think>

---

Read file: undefined

---

<think><details><summary>Thought Process</summary>**Debugging prop issues**

I see that `GenericWorkshop.vue` expects a `workshop` prop, whereas `InformationAlchemy.vue` is using `workshopInfo`. The inconsistency here is that it needs both `workshopInfo` and `workshop` as optional props, but is missing the required `workshopInfo`. This might cause warnings since it only passes `workshop`. In `PointCounterpoint.vue`, the same issue arises with required `workshopInfo`. It's crucial to ensure that `:workshopInfo="workshop"` is passed or adjust the component accordingly to avoid errors. Additionally, components are relying on a mapping that doesn't seem to exist, which adds complexity.
**Resolving route issues**

I notice that the route parameter "id" is currently using a numeric ID, like in the path `/workshops/1`, but it should ideally be the slug `workshop_id`, such as `/workshops/information-alchemy`. The dynamic mapping relies on `componentMap` keyed by those slugs. The problem here is using a numeric database ID instead of the stable `workshop_id`, causing issues with direct navigation. I’m considering two options: either modify the backend to include a `type` field for consistency or adapt the frontend to align with the backend schema. I think it might be easier to adjust the frontend types to match the backend structure.
**Updating store actions**

I need to update the store action endpoints to align with the `/workshops/manage` paths and field names. The backend expects certain parameters like `collection_id`, `prompt`, and `llm_model` in the `POST /api/v1/workshops/{workshop_id}/execute` route, but our frontend sends `favorite_item_id` and `extraPayload` keys like `system_prompt`. This needs fixing since the backend doesn’t accept those. I should also rename `favorite_item_id` to `collection_id` on the frontend for consistency. Additionally, I’m considering updating the `Workshop` interface in `app/types/api.ts` to match the backend or creating a new `BackendWorkshop` type.
**Simplifying updates**

I think the simplest updates would be to start with the store's `fetchWorkshops` to use the new type and adjust `goToWorkshop` to route to `/workshops/${workshop.workshop_id}`. I might also want to update the `[id].vue` to recognize `workshop_id` as a slug. 

Next, I need to either update `getWorkshopById` or create `getWorkshopBySlug` to locate workshops by `workshop_id`. 

For `updateWorkshop`, I should call the appropriate endpoint with `WorkshopUpdate` fields, and make sure `WorkshopConfigForm.vue` uses the right backend fields. Lastly, `createWorkshop` needs to call `POST /workshops/manage` with a required `workshop_id` slug, as the current form doesn't include it.
**Proposing updates**

I need to be cautious about making too many changes. I recommend unifying `workshop_id` as the slug and addressing the issue with the `/workshops/1` numeric ID in `[id].vue`, which isn't passing the required props. Additionally, we have various improvement ideas like search/filter options, UI enhancements, and error handling.

When making updates, I should suggest specific code changes but we might not need to implement them all. I’ll focus on ensuring that the frontend integrates smoothly with the backend, especially in naming conventions and data structures. Overall, a concise bullet list of proposals will help clarify the necessary actions for the user.
**Refining component props**

I need to address the issue with passing props in Vue. `GenericWorkshop` doesn’t define the required `workshopInfo` prop, which could lead to some confusion. I could use `v-bind`, but it might cause unwanted attributes at the root level. Instead, I should unify props across components by making `workshop` required and `workshopInfo` optional. This adjustment would improve consistency and minimize potential errors.

For now, I recommend listing the necessary changes without implementing them, focusing on the user’s concern about UI aesthetics. They requested improvements, so I’ll provide a detailed list of the required changes.
**Mapping field improvements**

I’ve listed some field mappings to align with backend requirements, like changing `system_prompt` to `default_prompt` and renaming `user_prompt_template`. Additionally, I've identified several improvements such as adding loading skeletons, search/filter options, error states for websockets, and unique slug validation.

I also need to address the `/workshops/1` issue by switching to slug usage and modifying endpoints. For now, I’ll analyze the necessary changes without implementing them yet since we’re waiting on user confirmation regarding UI design prompts. I’ll summarize these findings and propose safe fixes before proceeding with code modifications.
**Providing analysis and recommendations**

I’ve decided it's best to hold off on implementing code changes for now and instead focus on providing a thorough analysis and a list of recommended changes. I'll keep the TODO status as 'in_progress' since that's acceptable. 

Here’s what I’ll summarize in Chinese, beginning with the status update: "我刚读完 `workshops.vue`、`[id].vue`、store、后端接口。下面是问题与建议；等你给出提示词后我再改 UI 并同步接口。” 

I’ll highlight mismatches in the code and outline the necessary UI improvements, backend changes, and other enhancements. This will help set the stage for future adjustments.</details></think>

---

I’ve read `workshops.vue`、`workshops/[id].vue`、`stores/workshops.ts` 和后端的 Workshops/Tasks 接口与模型。下面是结论与可执行建议；等你给出“设计提示词”后，我会按该方向改 UI 并同步接口。

### 1) workshops.vue 为什么丑 + 改造方向
- 关键问题
  - 仅用基础 `Card`+按钮，无视觉层次与信息架构；没有图标/封面/执行方式等“可扫读线索”；网格间距与留白不均，空态/加载态反馈弱。
- 改造方向（等你给提示词后我按此落地）
  - 头部：带渐变/噪点背景的 Hero，标题+副标题+“新建工坊”主按钮。
  - 卡片：左上角放图标/缩略封面，主体两行（名称、1~2 行简介），底部是“进入”“快速执行”双按钮，右上角更多菜单。卡片悬停阴影+浮层渐变。
  - 标签/提示：在卡片上显示 `executor_type` 标签（如 llm_chat）、模型短名（如 gpt-4o-mini）、是否推荐等。
  - 交互：搜索/过滤（按类型、执行器、模型），排序（最近使用/名称），加载骨架屏与空态插画。
  - 主题一致性：暗色模式优化、细节半透明边框和柔和色彩，统一圆角和阴影等级。

### 2) 点击后跳到了 /workshops/1 的问题本质
- 使用了错误的 ID 与字段，且“详情页”数据/映射不匹配造成一系列连锁错误。
- 具体问题点
  - 前端把卡片点击路由到数字 ID：
    ```49:101:app/pages/workshops.vue
    const goToWorkshop = (workshopId: string) => {
      router.push(`/workshops/${workshopId}`)
    }
    ```
    实际传入的是 `workshop.id`（数字），导致 URL 是 `/workshops/1`。
  - 但组件映射是按“类型/slug”来找组件的，前端却去读 `workshop.type`：
    ```13:18:app/pages/workshops/[id].vue
    const loader = workshopsStore.getComponentLoader(workshop.value.type)
    ```
    后端并没有返回 `type`，而是返回 `workshop_id`（例如 information-alchemy、point-counterpoint…）。
  - 详情页查找也错了：用的是“数字 id 严格等值匹配字符串参数”，经常找不到数据：
    ```161:168:app/stores/workshops.ts
    getWorkshopById(id: string) {
      return this.workshops.find(w => w.id === id)
    }
    ```
    如果 URL 是 "1"，而列表里 `id` 是数字 1，严格等值等不着；且刷新直达详情页时，列表未拉取也会是空。
  - 执行接口请求体字段不匹配：
    - 前端发 `favorite_item_id`，后端要求 `collection_id`。
    - 前端额外传 `system_prompt`、`user_prompt_template`，后端并不接收这些字段（只接收 `prompt`、`llm_model` 可选）。
- 正确方案（前后端最小改动）
  - 路由改用 slug：把“进入工坊”跳转到 `/workshops/${workshop.workshop_id}`。
  - 详情页用 slug 查找：`getWorkshopBySlug(slug) => w.workshop_id === slug`，并在直达时兜底拉取 `fetchWorkshops()`。
  - 动态组件映射改为基于 `workshop.workshop_id`（如 'information-alchemy'、'point-counterpoint' 等），找不到时 fallback 到 Generic。
  - 组件入参统一：详情页给动态组件同时传 `workshop`（必需）即可；现有两个特化组件要求 `workshopInfo`，需要统一为 `workshop`。
  - 执行接口改参名：把 `favorite_item_id` 改成 `collection_id`，自定义文本统一用 `prompt`，模型用 `llm_model`。

### 3) 后端数据需要改什么
- 必需（为了最小摩擦统一前端）
  - 不必改表结构；前端改用已有的 `workshop_id` 做 slug 与组件映射即可。
  - 建议加一个“按 slug 获取单条”的只读接口，便于详情页直达时只拉一条：
    - GET `/api/v1/workshops/manage/{workshop_id}` → 返回单条（现在只有列表 + 按 slug 的 PUT/DELETE）。
- 推荐（支撑更美的列表 UI，不动表结构）
  - 在 `executor_config` 增加 UI 元数据（走 JSON，不加列）：`{ ui: { icon: 'Sparkles', color: '#7C3AED', cover_url: '...' } }`。
  - 后台“默认模型/提示词”更语义化：沿用 `default_model`、`default_prompt`（已存在），便于前端展示。
  - 可选统计：给列表返回最近 7 天执行次数/总执行次数，丰富卡片信息（不急，后续迭代）。

### 4) 前端需要同步的改动清单（可一次性修好）
- 列表页 `workshops.vue`
  - 跳转使用 slug：`router.push('/workshops/' + workshop.workshop_id)`。
  - 卡片上显示 `executor_type`、`default_model` 的 Badge；加载骨架与空态。
- 详情页 `workshops/[id].vue`
  - 直达兜底：若 store 为空则拉取列表；找不到时根据 slug 再请求单条（等后端加接口时接入）。
  - 组件映射：`getComponentLoader(workshop.workshop_id)`；传参统一为 `:workshop="workshop"`。
- store `app/stores/workshops.ts`
  - 补充 `getWorkshopBySlug(slug: string)`；`getWorkshopById` 暂留兼容。
  - `executeWorkshop` 请求体：`{ collection_id, prompt, llm_model }`，移除 `favorite_item_id`、`system_prompt`、`user_prompt_template`。
  - CRUD 走 `/workshops/manage`，`update/delete` 用 `workshop_id` 作为路径参数；`create` 需要有 `workshop_id`（前端表单要补这个字段）。
- 表单 `WorkshopConfigForm.vue`
  - 字段对齐后端：`workshop_id`（slug）、`name`、`description`、`default_prompt`、`default_model`、`executor_type`、`executor_config(JSON)`。
  - 现有的 `type/system_prompt/user_prompt_template/model` 映射到后端字段（或先隐藏不支持的）。

### 5) 还可改进的点
- 列表交互：搜索/过滤/排序、批量操作、最近使用置顶。
- 卡片“快速执行”：下拉选择收藏后直接派任务，无需进入详情。
- 任务反馈：全局 Toaster + 列表内任务进度 Badge；失败重试按钮。
- 稳定性：WS 断线重连、直达详情 SSR/预取、空态/失败态兜底文案。

小结
- 根因：前端用“数字 id 路由 + 前端自定义字段(type/system_prompt/…)”，而后端返回的是 `workshop_id/ default_* / executor_*`；执行接口参数也不匹配。
- 解决：路由与组件映射统一用 `workshop_id`；详情页直达兜底拉取；执行接口改参；表单/CRUD 字段对齐后端。UI 改造等你给提示词后我按方案上色与布局落地。

---

